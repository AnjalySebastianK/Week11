# Reverse Shells – Detailed Explanation

---

## What is a Reverse Shell?
A **reverse shell** is a type of shell session where the **target machine initiates a connection to the attacker’s machine** instead of the attacker connecting directly.

- Normally, a shell allows a user to execute commands on a system.
- In a **reverse shell**, the compromised system connects out to the attacker, giving the attacker remote control.
- Often used to **bypass firewalls or NAT**, because outbound connections are usually allowed, while inbound connections might be blocked.

---

## How Reverse Shells Work

1. **Attacker Prepares Listener** – The attacker sets up a server to listen on a specific port.
2. **Victim Executes Payload** – A malicious script/program on the victim machine runs.
3. **Outbound Connection** – The victim connects to the attacker’s listener.
4. **Shell Established** – The attacker now has command-line access to the victim system.
5. **Command Execution** – The attacker can run commands, exfiltrate data, or pivot to other systems.

---

## Types of Reverse Shells

1. **TCP Reverse Shell** – Uses a direct TCP connection. Common, reliable, but can be detected by network monitoring.
2. **UDP Reverse Shell** – Uses UDP instead of TCP. Can bypass some firewall rules, but less reliable.
3. **HTTP/HTTPS Reverse Shell** – Uses HTTP/HTTPS traffic to avoid detection. Often blends with normal web traffic.
4. **DNS Reverse Shell** – Encodes commands and responses over DNS queries. Evades firewalls, but slower.
5. **Web-Based Reverse Shell** – Deployed via web scripts (PHP, ASP, JSP) in web servers. Common in web attacks.

---

## Tools Used for Reverse Shells

- **Netcat (nc)** – Simple and widely used for TCP reverse shells.
- **Metasploit Framework** – Generates reverse shell payloads for multiple platforms.
- **Python / Bash / PowerShell Scripts** – Custom reverse shells.
- **Socat** – Advanced networking utility for shell connections.
- **Cobalt Strike / Empire** – Professional pentesting tools with reverse shell modules.

---

## Case Studies / Real-World Examples

1. **Targeted Penetration Tests** – Reverse shells simulate attacker behavior in controlled pentests.
2. **APT Attacks** – Nation-state attacks use reverse shells via HTTPS or DNS for stealthy access.
3. **Web Server Exploits** – Attackers upload PHP web shells to compromise servers and gain reverse shell access.

---

## Layer of the OSI Model Affected

- **Application Layer (Layer 7)** – Scripts like PHP, PowerShell, or Python.
- **Transport Layer (Layer 4)** – TCP/UDP connections establish the session.
- **Network Layer (Layer 3)** – IP packets traverse the network.

---

## Detection & Prevention

**Detection:**
- Monitor outbound connections to unusual IPs/ports.
- Use intrusion detection systems (IDS/IPS) for unusual traffic patterns.
- Look for abnormal process execution or network connections from servers.

**Prevention:**
- Block unnecessary outbound connections.
- Apply strict firewall and network segmentation rules.
- Keep software and scripts updated.
- Deploy endpoint monitoring and anomaly detection.
- Validate and sanitise all user uploads in web applications.

---

## Summary
A **reverse shell** allows attackers to get command-line access by having the victim machine connect to them. It’s commonly used to bypass firewalls and is implemented in multiple protocols, including TCP, UDP, HTTP, and DNS. Detection involves monitoring outbound traffic and process behavior, while prevention relies on firewalls, endpoint monitoring, and secure coding practices.
